{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <div class="d-flex align-items-center gap-3">
    {% if profile.profile_pic %}
      <img src="{{ profile.profile_pic.url }}" class="rounded-circle" style="width:90px;height:90px;object-fit:cover;">
    {% endif %}
    <div>
      <h2 class="mb-1">{{ profile.full_name|default:subject.get_username }}</h2>
      {% if profile.nicknames %}
        <div class="text-muted small">aka: {{ profile.nicknames|join:", " }}</div>
      {% endif %}
    </div>
  </div>

  {% if profile.about_me %}
    <div class="mt-3">{{ profile.about_me|linebreaksbr }}</div>
  {% endif %}

  {% if profile.socials.all %}
  <div class="mt-4">
    <h5>Socials</h5>
    <ul class="list-unstyled d-flex flex-wrap gap-3">
      {% for s in profile.socials.all %}
  <li>
    <a href="{{ s.url }}" target="_blank" rel="noopener" class="d-inline-flex align-items-center gap-1">
      {% if s.icon_key and s.icon_key != "other" %}
        <span class="icon-{{ s.icon_key }}" aria-hidden="true"></span>
      {% endif %}
      <span>{{ s.label|default:s.get_platform_display }}</span>
    </a>
  </li>
{% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if profile.images.all %}
  <div class="mt-4">
    <h5>Library</h5>
    <div class="row g-3">
      {% for img in profile.images.all %}
        <div class="col-6 col-md-3">
          <img src="{{ img.image.url }}" class="img-fluid rounded">
          {% if img.caption %}<div class="small text-muted mt-1">{{ img.caption }}</div>{% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% if profile.custom_fields %}
  <div class="mt-4">
    <h5>Custom</h5>
    <dl class="row">
      {% for cf in profile.custom_fields %}
        <dt class="col-sm-3">{{ cf.key }}</dt>
        <dd class="col-sm-9">
          {% if cf.type == "url" %}<a href="{{ cf.value }}" target="_blank">{{ cf.value }}</a>
          {% else %}{{ cf.value }}{% endif %}
        </dd>
      {% endfor %}
    </dl>
  </div>
  {% endif %}

  <a href="{% url 'journal:profile_edit' %}" class="btn btn-primary mt-3">Edit Profile</a>
</div>
{% endblock %}